---
title: "Lab1"
output: html_notebook
---

# Dependencies

```{r}
install.packages("readxl")
library("readxl")
```

# Distribution Properties

```{r}
confeps <- function(sample, conf) {
  int <- t.test(sample, conf.level = conf)$conf.int
  (int[2] - int[1]) / 2
}

distprops <- function(data, samplecnts = c(10, 50, 100, 200, 300)) {
  samples <- sapply(samplecnts, function(cnt) data[1:cnt])
  data.frame(
    row.names = samplecnts,
    means = sapply(samples, mean),
    epsilon90 = sapply(samples, confeps, conf = 0.9),
    epsilon95 = sapply(samples, confeps, conf = 0.95),
    epsilon99 = sapply(samples, confeps, conf = 0.99),
    variances = sapply(samples, var),
    stddevs = sapply(samples, sd),
    cfvars = sapply(samples, function(s) sd(s) / mean(s))
  )
}

writeprops <- function(props) {
  colnames(props) <- c("Мат. ож.", "Дов. инт (0.9)", "Дов. инт (0.95)", "Дов. инт. (0.99)", "Дисперсия", "С. к. о.", "К-т вариации")
  write.csv(format(t(props), ditigs = 4))
}
```

# Lab Data

```{r}
labdata <- unlist(read_excel("3302_Лабушев-Нестеров.xlsx", col_names = FALSE))
writeprops(distprops(labdata))
```

## Plot

```{r}
plot(labdata, type = "h", main = "График 1. Значения исходной последовательности", xlab = "Порядковый номер элемента", ylab = "Значение элемента")
```

# Autocorrelation

```{r}
atable <- acf(labdata, plot = FALSE, lag.max = 10)$acf[2:11]
write.csv(format(t(atable), digits = 3))
```

## Plot

```{r}
plot(atable, type = "b", main = "График 2. Автокорреляция исходной последовательности", xlab = "Сдвиг последовательности", ylab = "Коэффициент автокорреляции")
```

# Histogram

```{r}
hist(labdata, breaks = 100, main = "График 3. Гистограмма распределения частот последовательности", xlab = "Интервалы значений", ylab = "Частота")
```

# Approximation

```{r}
hist(labdata, breaks=100, main="Гистограмма распределения частот", xlab="Интервалы значений", ylab="Частота")
```

## Approximation

```{r}

```